<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Immobilienbewertung Premium | SW Immobilien</title>

<link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css"/>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<style>
:root{
--primary:#0d3b66;
--accent:#b89c62;
--bg:#f4f6f9;
--card:#ffffff;
}

body{
margin:0;
font-family:system-ui,-apple-system,BlinkMacSystemFont,sans-serif;
background:var(--bg);
color:#111;
}

.wrapper{
max-width:1100px;
margin:auto;
}

.step{
display:none;
padding:60px;
background:var(--card);
border-radius:20px;
margin:40px 0;
box-shadow:0 10px 30px rgba(0,0,0,0.04);
}

.step.active{
display:block;
}

h2,h3{
color:var(--primary);
margin-bottom:30px;
}

.grid{
display:grid;
gap:20px;
grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
}

.card{
border:1px solid #e3e6ea;
border-radius:18px;
padding:30px;
cursor:pointer;
text-align:center;
transition:.25s;
position:relative;
background:#fff;
}

.card:hover{
border-color:var(--primary);
transform:translateY(-3px);
}

.card.selected{
border:2px solid var(--primary);
background:#f0f6fc;
}

.badge{
position:absolute;
top:10px;
right:10px;
background:var(--primary);
color:#fff;
width:24px;
height:24px;
border-radius:50%;
display:flex;
align-items:center;
justify-content:center;
font-size:12px;
}

button{
padding:16px 28px;
border-radius:14px;
border:none;
cursor:pointer;
font-weight:600;
}

.btn-primary{
background:var(--primary);
color:#fff;
}

.btn-secondary{
background:#fff;
border:1px solid var(--primary);
color:var(--primary);
}

input,select{
width:100%;
padding:14px;
border-radius:12px;
border:1px solid #ddd;
margin-bottom:20px;
}

#map{
height:350px;
border-radius:18px;
margin-top:20px;
}

.range-bar{
height:6px;
background:linear-gradient(90deg,var(--primary),var(--accent));
border-radius:4px;
margin-bottom:20px;
}

.hidden{
display:none;
}

.progress{
height:4px;
background:#eaeaea;
margin-bottom:30px;
}

.progress-fill{
height:4px;
background:var(--primary);
width:0%;
transition:.3s;
}

.footer{
text-align:center;
padding:40px;
font-size:14px;
color:#666;
}
</style>
</head>

<body>
<div class="wrapper">

<div class="progress">
<div class="progress-fill" id="progressFill"></div>
</div>

<!-- STEP 1 -->
<div class="step active" id="step1">
<h2>Welche Art Immobilie?</h2>

<div class="grid" id="categoryGrid">
<div class="card" onclick="selectCategory(this,'Haus')">Haus</div>
<div class="card" onclick="selectCategory(this,'Wohnung')">Wohnung</div>
<div class="card" onclick="selectCategory(this,'Gewerbe')">Gewerbe</div>
<div class="card" onclick="selectCategory(this,'Grundstück')">Grundstück</div>
</div>

<br>
<button class="btn-primary" onclick="nextStep(2)">Weiter</button>
</div>

<!-- STEP 2 Zustand -->
<div class="step" id="step2">
<h2>Zustand</h2>

<div class="grid" id="conditionGrid">
<div class="card" onclick="selectCondition(this,'Neubau')">Neubau</div>
<div class="card" onclick="selectCondition(this,'Modernisiert')">Modernisiert</div>
<div class="card" onclick="selectCondition(this,'Gepflegt')">Gepflegt</div>
<div class="card" onclick="selectCondition(this,'Renovierungsbedürftig')">Renovierungsbedürftig</div>
<div class="card" onclick="selectCondition(this,'Saniert')">Saniert</div>
</div>

<div id="renovationWrapper" class="hidden">
<label>Sanierungsjahr</label>
<input type="number" id="renovationYear">
</div>

<br>
<button class="btn-secondary" onclick="prevStep()">Zurück</button>
<button class="btn-primary" onclick="nextStep(3)">Weiter</button>
</div>

<!-- STEP 3 Ausstattung -->
<div class="step" id="step3">
<h2>Ausstattungsqualität</h2>

<div class="grid" id="qualityGrid">
<div class="card" onclick="selectQuality(this,'Einfach')">Einfach</div>
<div class="card" onclick="selectQuality(this,'Standard')">Standard</div>
<div class="card" onclick="selectQuality(this,'Gehoben')">Gehoben</div>
<div class="card" onclick="selectQuality(this,'Luxus')">Luxus</div>
</div>

<br>
<button class="btn-secondary" onclick="prevStep()">Zurück</button>
<button class="btn-primary" onclick="nextStep(4)">Weiter</button>
</div>

<!-- STEP 4 Besonderheiten -->
<div class="step" id="step4">
<h2>Besonderheiten</h2>

<div class="grid" id="featureGrid"></div>

<br>
<button class="btn-secondary" onclick="prevStep()">Zurück</button>
<button class="btn-primary" onclick="nextStep(5)">Weiter</button>
</div>

<!-- STEP 5 Lage -->
<div class="step" id="step5">
<h2>Lage & Marktdaten</h2>

<input type="text" id="addressInput" placeholder="Adresse eingeben">

<div id="map"></div>

<br>
<button class="btn-secondary" onclick="prevStep()">Zurück</button>
<button class="btn-primary" onclick="confirmAddress()">Adresse bestätigen</button>
</div>

<!-- STEP 6 Marktindikation -->
<div class="step" id="step6">
<h2>Erste Marktindikation</h2>

<h3 id="priceDisplay"></h3>

<br>
<button class="btn-primary" onclick="nextStep(7)">Detailanalyse</button>
</div>

<!-- STEP 7 Detail -->
<div class="step" id="step7">
<h2>Detailanalyse erhalten</h2>

<label>
<input type="checkbox" id="callbackCheck" onchange="togglePhone()"> Rückruf gewünscht
</label>

<input type="text" placeholder="Name" id="name">
<input type="email" placeholder="E-Mail" id="email">

<div id="phoneWrapper" class="hidden">
<input type="text" placeholder="Telefonnummer" id="phone">
</div>

<button class="btn-secondary" onclick="prevStep()">Zurück</button>
<button class="btn-primary" onclick="sendFinal()">Analyse erhalten</button>
</div>

<div class="footer">
<a href="https://sw-immobilien.de/datenschutz">Datenschutz</a>
</div>

</div>

<script>
let currentStep=1;
let formData={features:{}};

function nextStep(step){
document.querySelectorAll(".step").forEach(s=>s.classList.remove("active"));
document.getElementById("step"+step).classList.add("active");
currentStep=step;
document.getElementById("progressFill").style.width=(step/7*100)+"%";
}

function prevStep(){
nextStep(currentStep-1);
}

function selectCategory(el,val){
document.querySelectorAll("#categoryGrid .card").forEach(c=>c.classList.remove("selected"));
el.classList.add("selected");
formData.category=val;
}

function selectCondition(el,val){
document.querySelectorAll("#conditionGrid .card").forEach(c=>c.classList.remove("selected"));
el.classList.add("selected");
formData.condition=val;

if(val==="Saniert"){
document.getElementById("renovationWrapper").classList.remove("hidden");
}else{
document.getElementById("renovationWrapper").classList.add("hidden");
}
}

function selectQuality(el,val){
document.querySelectorAll("#qualityGrid .card").forEach(c=>c.classList.remove("selected"));
el.classList.add("selected");
formData.quality=val;
}

const featureList=["Garage","Stellplatz","Pool","Einliegerwohnung","Sauna","Gäste-WC","Keller","Balkon","Terrasse"];

featureList.forEach(f=>{
let div=document.createElement("div");
div.className="card";
div.innerText=f;
div.onclick=()=>toggleFeature(div,f);
document.getElementById("featureGrid").appendChild(div);
});

function toggleFeature(el,name){
if(!formData.features[name]) formData.features[name]=0;

if(el.classList.contains("selected")){
formData.features[name]--;
if(formData.features[name]<=0){
formData.features[name]=0;
el.classList.remove("selected");
let b=el.querySelector(".badge");
if(b) b.remove();
return;
}
}else{
el.classList.add("selected");
formData.features[name]=1;
}

let badge=el.querySelector(".badge");
if(!badge){
badge=document.createElement("div");
badge.className="badge";
el.appendChild(badge);
}
badge.innerText=formData.features[name];
}

function togglePhone(){
document.getElementById("phoneWrapper").classList.toggle("hidden");
}

let map=L.map("map").setView([51,10],6);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(map);
let marker=L.marker([51,10]).addTo(map);

document.getElementById("addressInput").addEventListener("change",function(){
fetch("https://nominatim.openstreetmap.org/search?format=json&q="+this.value)
.then(r=>r.json())
.then(data=>{
if(data[0]){
marker.setLatLng([data[0].lat,data[0].lon]);
map.setView([data[0].lat,data[0].lon],15);
formData.address=data[0].display_name;
}
});
});

function confirmAddress(){
document.getElementById("priceDisplay").innerText="450.000 € – 480.000 €";
nextStep(6);
}

function sendFinal(){
alert("Analyse versendet");
}
</script>

</body>
</html>